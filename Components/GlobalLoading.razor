@inject Services.LoadingService LoadingService
@implements IDisposable

@if (_visible)
{
    <div class="global-loading-overlay">
        <MudProgressCircular Indeterminate="true" Size="Size.Large" Color="Color.Primary" />
    </div>
}

@code {
    private bool _visible;

    protected override void OnInitialized()
    {
        LoadingService.OnShow += Show;
        LoadingService.OnHide += Hide;
        _visible = LoadingService.IsLoading;
    }

    private void Show()
    {
        _visible = true;
        InvokeAsync(StateHasChanged);
    }
    private void Hide()
    {
        _visible = false;
        InvokeAsync(StateHasChanged);
    }
    public void Dispose()
    {
        LoadingService.OnShow -= Show;
        LoadingService.OnHide -= Hide;
    }
}

<style>
.global-loading-overlay {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(255,255,255,0.7);
    z-index: 9999;
    display: flex;
    align-items: center;
    justify-content: center;
}
</style>
