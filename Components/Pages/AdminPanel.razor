@page "/admin-panel"
@inject Data.Services.MappedBrickExportService MappedExport
@inject Data.Services.ItemSetExportService SetExport

<MudText Typo="Typo.h4" GutterBottom="true">Admin Panel</MudText>

<MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="ExportMappings">Export Mappings</MudButton>
<MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="ExportSets">Export Sets</MudButton>

<div>@statusMessage</div>

@code {
    private string statusMessage = "";

    private async Task ExportMappings()
    {
        try
        {
            var count = await MappedExport.ExportMappedBricksAsync();
            statusMessage = $"Export erfolgreich: {count} Mappings gespeichert. (Pfad: {MappedExport.GetExportPath()})";
        }
        catch (Exception ex)
        {
            statusMessage = $"Fehler beim Export: {ex.Message}";
        }
    }

    private async Task ExportSets()
    {
        try
        {
            var count = await SetExport.ExportSetsAsync();
            statusMessage = $"Sets-Export erfolgreich: {count} Sets gespeichert. (Pfad: {count})";
        }
        catch (Exception ex)
        {
            statusMessage = $"Fehler beim Sets-Export: {ex.Message}";
        }
    }
}
