@using brickapp.Data.Services
@inject RequestService RequestService
@inject UserService UserService
@inject NotificationService NotificationService
@inject LoadingService LoadingService
@inject ILogger<AddItemDialog> Logger

<MudDialog>
    <DialogContent>
        <MudSelect T="string" Label="Brand" @bind-Value="Brand" Required="true">
            <MudSelectItem Value="@("Lego")">Lego</MudSelectItem>
            <MudSelectItem Value="@("BlueBrixx")">BlueBrixx</MudSelectItem>
            <MudSelectItem Value="@("Cada")">Cada</MudSelectItem>
            <MudSelectItem Value="@("Pantasy")">Pantasy</MudSelectItem>
            <MudSelectItem Value="@("Mould King")">Mould King</MudSelectItem>
            <MudSelectItem Value="@("Unknown")">Unknown</MudSelectItem>
        </MudSelect>
        <MudTextField @bind-Value="Name" Label="Item Name" Required="true" />
        <MudTextField @bind-Value="PartNum" Label="Part Number" Required="@(Brand == "Lego")" />
        @if (Brand == "Lego" && string.IsNullOrWhiteSpace(PartNum))
        {
            <MudAlert Severity="Severity.Warning">For LEGO, the part number is required!</MudAlert>
        }
        <InputFile OnChange="OnInputFileChange" />
        @if (!string.IsNullOrWhiteSpace(_errorMessage))
        {
            <MudAlert Severity="Severity.Error">@_errorMessage</MudAlert>
        }
        @if (!string.IsNullOrWhiteSpace(_imagePreviewUrl))
        {
            <img src="@_imagePreviewUrl" style="max-width:200px;max-height:200px;margin-top:8px;" />
        }
    </DialogContent>
    <DialogActions>

        <MudButton OnClick="Cancel" Color="Color.Secondary">Cancel</MudButton>
        <MudButton Variant="Variant.Filled" StartIcon="@Icons.Material.Filled.Save" OnClick="OnSave"
            Color="Color.Primary" Disabled="_loading">
            Save
        </MudButton>
    </DialogActions>
</MudDialog>