@using brickapp.Data.Entities
@using brickapp.Data.Services
@inject RequestService RequestService
@inject UserService UserService
@inject NotificationService NotificationService
@inject LoadingService LoadingService
@inject ILogger<UploadItemImageDialog> Logger

<MudDialog>
    <DialogContent>
        <MudText Typo="Typo.body1" GutterBottom="true">
            Upload an image for: <strong>@Brick?.Name</strong> <br/>
            @if (!string.IsNullOrWhiteSpace(Brick?.LegoPartNum))
            {
                <MudText Typo="Typo.caption" Color="Color.Secondary">Lego Part #: @Brick.LegoPartNum</MudText>
            }
            else if (!string.IsNullOrWhiteSpace(Brick?.BluebrixxPartNum))
            {
                <MudText Typo="Typo.caption" Color="Color.Secondary">BlueBrixx Part #: @Brick.BluebrixxPartNum</MudText>
            }
            else if (!string.IsNullOrWhiteSpace(Brick?.CadaPartNum))
            {
                <MudText Typo="Typo.caption" Color="Color.Secondary">Cada Part #: @Brick.CadaPartNum</MudText>
            }
            else if (!string.IsNullOrWhiteSpace(Brick?.PantasyPartNum))
            {
                <MudText Typo="Typo.caption" Color="Color.Secondary">Pantasy Part #: @Brick.PantasyPartNum</MudText>
            }
            else if (!string.IsNullOrWhiteSpace(Brick?.MouldKingPartNum))
            {
                <MudText Typo="Typo.caption" Color="Color.Secondary">Mould King Part #: @Brick.MouldKingPartNum</MudText>
            }
        </MudText>
        
        <MudDivider Class="my-3" />
        
        <MudAlert Severity="Severity.Info" Dense="true" Class="mb-3">
            <MudText Typo="Typo.caption">
                <strong>Please note:</strong> By uploading an image, you confirm that you have the necessary rights to use it 
                and that it does not violate any copyrights or contain prohibited content (e.g., illegal, offensive, or inappropriate material).
            </MudText>
        </MudAlert>
        
        <InputFile OnChange="OnInputFileChange" accept="image/*" />
        
        @if (!string.IsNullOrWhiteSpace(_imagePreviewUrl))
        {
            <MudPaper Class="mt-3 pa-2" Elevation="1">
                <MudText Typo="Typo.caption" GutterBottom="true">Preview:</MudText>
                <img src="@_imagePreviewUrl" style="max-width:100%;max-height:300px;border-radius:4px;" />
            </MudPaper>
        }
        
        @if (!string.IsNullOrWhiteSpace(_errorMessage))
        {
            <MudAlert Severity="Severity.Error" Class="mt-3">@_errorMessage</MudAlert>
        }
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="Cancel" Color="Color.Secondary" Disabled="_loading">Cancel</MudButton>
        <MudButton Variant="Variant.Filled"
                   StartIcon="@Icons.Material.Filled.Upload"
                   OnClick="OnSave"
                   Color="Color.Primary"
                   Disabled="@(_loading || _file == null)">
            Upload
        </MudButton>
    </DialogActions>
</MudDialog>